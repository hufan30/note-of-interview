# top命令
top命令提供了实时的对系统处理器的状态监视.它将显示系统中CPU最“敏感”的任务列表.该命令可以按CPU使用.内存使用和执行时间对任务进行排序；而且该命令的很多特性都可以通过交互式命令或者在个人定制文件中进行设定.

![](../images/15262805942603.jpg)

## 1. 显示内容

- 第一行：**任务队列信息**
    - 10:01:23 当前系统时间
    - **days**：系统运行时间，格式为时:分（在这期间没有重启过）
    - **users**：当前登录用户数
    - **load average**: 1.15, 1.42, 1.44 load average后面的三个数分别是**1分钟、5分钟、15分钟**的负载情况。
    
- 第二行：**进程信息**
    - Tasks 任务（进程），
    - **totoal**： 系统现在共有进程数，
    - **running**：其中处于运行中进程个数。
    - **sleeping**：休眠中的线程数。
    - **stoped**：停止的进程数
    - **zombie**：僵尸进程数
 
- 第三行：**cpu状态**
    - 6.7% **us**：用户空间占用CPU的百分比。
    - 0.4% **sy**：内核空间占用CPU的百分比。
    - 0.0% **ni**：改变过优先级的进程占用CPU的百分比
    - 92.9% **id**：空闲CPU百分比
    - 0.0% **wa**：IO等待占用CPU的百分比
    - 0.0% **hi**： 硬中断（Hardware IRQ）占用CPU的百分比
    - 0.0% **si** 软中断（Software Interrupts）占用CPU的百分比

- 第四行：**内存状态**
    - **total**: 物理内存总量
    - **used**: 使用中的内存总量
    - **free**: 空闲内存总量
    - **buffers**: 缓存的内存量
 
- 第五行：**swap交换分区**
    - **total**: 交换区总量
    - **used**: 使用的交换区总量
    - **free**: 空闲交换区总量
    - **cached**: 缓冲的交换区总量

- 第六行：进程信息

![](../images/15262813568697.jpg)


## 2. load average
可参考： 

 - [理解Linux系统负荷](http://www.ruanyifeng.com/blog/2011/07/linux_load_average_explained.html)
 - [Understanding Linux CPU Load - when should you be worried?](http://blog.scoutapp.com/articles/2009/07/31/understanding-load-averages)

系统平均负载被定义为在**特定时间间隔内运行队列中(在CPU上运行或者等待运行多少进程)的平均进程数**。如果一个进程满足以下条件则其就会位于运行队列中：

 - 它没有在等待I/O操作的结果
 - 它没有主动进入等待状态(也就是没有调用’wait’)
 - 没有被停止(例如：等待终止)
 
是指系统的运行队列的平均利用率，也可以认为是可运行进程的平均数

### Load误解
 - 系统load高一定是性能有问题。
   - 真相：Load高也许是因为在进行cpu密集型的计算
 - 系统Load高一定是CPU能力问题或数量不够？
   - 真相：Load高只是代表需要**运行的队列累计过多了**。但队列中的任务实际可能是耗Cpu的，也可能是耗I/O
- 在Load average 高的情况下如何鉴别系统瓶颈。
   - 是CPU不足，还是io不够快造成或是内存不足？

